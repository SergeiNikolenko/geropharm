## Цель

Продемонстрировать навыки работы с химическими библиотеками, SAR-анализом, фильтрацией и структурной трансформацией соединений.

---

## Контекст

Вы готовите внутреннюю библиотеку соединений к виртуальному скринингу, оцениваете её качество и помогаете выявить перспективные scaffold’ы для дальнейшего синтеза.

---

## Исходные данные

- **Файл**: `input_library.smi` (формат: SMILES + идентификатор), ~3000 молекул  
  Часть соединений:
    - содержит соли/гидраты,
    - не соответствует drug-like правилам,
    - имеет нежелательные подструктуры (PAINS, REOS и др.),
    - включает повторяющиеся или близкородственные соединения.

---

## Необходимо выполнить

### 1. Стандартизация и очистка библиотеки

- Привести все структуры к canonical SMILES (RDKit)
- Удалить соли, гидраты, протомеры
- Объединить дубликаты, определить ближайшие аналоги по Tanimoto-сходству (ECFP4)
- Отфильтровать соединения по:
    - правилам Lipinski, Veber, Ghose
    - PAINS и REOS фильтрам (готовые SMARTS)

---

### 2. Вычисление дескрипторов и кластеризация

- Рассчитать дескрипторы: MW, TPSA, logP, HBA, HBD, rotatable bonds, QED и др.
- Кластеризация по структурному сходству (например, Butina или K-means на эмбеддингах)
- Визуализировать основные кластеры, рассчитать их разнообразие (intra-cluster similarity)

---

### 3. SAR-анализ

- Для поднабора с известной биологической активностью (`.csv` с активностью):
    - Построить matched molecular pairs (MMP)
    - Выделить ключевые трансформации, улучшающие активность
    - Визуализировать примеры (например, “R-group analysis”)

---

### 4. Подготовка hit-листа

- Из отфильтрованной библиотеки выбрать 25 наиболее перспективных молекул по:
    - drug-likeness (QED, rule-based фильтры)
    - scaffold novelty (Bemis–Murcko)
    - структурное разнообразие
- Для каждой: SMILES, дескрипторы, принадлежность кластеру, краткий комментарий

---

## Формат сдачи

- **Скрипт** на Python (желательно Jupyter Notebook, RDKit + Pandas/Plotly/Matplotlib)
- Итоговый **отчёт** (PDF или Markdown) с графиками, гистограммами, таблицами
- Отдельный файл **hitlist.csv** с выбранными молекулами

---

## Дополнительно

- Реализация workflow в KNIME или Pipeline Pilot
- Визуализация ключевых трансформаций (до/после) с комментариями
- Использование UMAP/t-SNE для проекции библиотеки на 2D-пространство
